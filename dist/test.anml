(def LOW_COLOR #505050)
(def HIGH_COLOR #71ed55)
(def WIRE_WIDTH 6)
(def BACKGROUND_COLOR #ffffff)

(def Switch
  (Rectangle
    (strokeColor LOW_COLOR)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 20)
    (height 20)
  )
)

(def Probe 
  (Circle
    (strokeColor LOW_COLOR)
    (fillColor $data._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 50)
  )
)

(def AndGate
  (Rectangle
    (x -6)
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 36)
    (height 40)
  )
  (Arc
    (x 10)
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 20)
    (startAngle -1.57)
    (endAngle 1.57)
  )
)

(def OrGate
  (Rectangle
    (x -6)
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 35)
    (height 40)
  )
  (Triangle
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 10) (y1 20)
    (x2 40) (y2 0)
    (x3 10) (y3 -20)
  )
  (Arc
    (x -40)
    (strokeColor none)
    (fillColor BACKGROUND_COLOR)
    (radius 25)
    (startAngle -1.2)
    (endAngle 1.2)
  )
)

(def NotGate
  (Triangle
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -15) (y1 15)
    (x2 15) (y2 0)
    (x3 -15) (y3 -15)
  )
  (Circle
    (x 18)
    (strokeColor none)
    (fillColor $data.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 5)
  )
)

(def NandGate
  (AndGate
    (dataKey _not)
  )
  (Circle
    (x 34)
    (strokeColor none)
    (fillColor $data._not.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 5)
  )
)

(def XnorGate
  (OrGate
    (dataKey _or)
    (x -27)
    (y 24)
  )
  
  (NandGate
    (dataKey _nand1)
    (x -27)
    (y -25)
  )
  
  (NandGate
    (dataKey _nand2)
    (x 70)
    (y -15)
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._or.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 9.948933579513827) (y 23.830390369021245))
      (Point (x 30.141635306935548) (y 23.830390369021245))
      (Point (x 30.141635306935548) (y -4.026139012117743))
      (Point (x 46.46382049119668) (y -4.026139012117743))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._nand1.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 11.643158764772938) (y -25.136165183762138))
      (Point (x 46.02856221961638) (y -25.136165183762138))
    )
  )
)

(def GreaterThan1
  (AndGate
    (dataKey _and)
    (x 32)
  )
  (NotGate
    (dataKey _not)
    (x -35)
    (y -10)
  )
  (Line
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._and._inA._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -50) (y1 10)
    (x2 9) (y2 10)
  )
  (Line
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._not.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -13) (y1 -10)
    (x2 9) (y2 -10)
  )
)

(def Comparator1
  (XnorGate
    (dataKey _xnor)
    (y 30)
  )
  (GreaterThan1
    (dataKey _gt)
    (y -40)
  )
)

(def Comparator2
  (Comparator1
    (dataKey _a1Compb1)
    (x -115.38554328942953)
    (y 68.37348052684563)
  )
  
  (Comparator1
    (dataKey _a0Compb0)
    (x -116)
    (y -76.68674026342282)
  )
  
  (AndGate
    (dataKey _andEq)
    (x 57)
    (y 73)
  )
  
  (AndGate
    (dataKey _andGt)
    (x 59)
    (y -51)
  )
  
  (OrGate
    (dataKey _or)
    (x 142)
    (y 18.120534603187977)
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._a1Compb1.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -6.3614642755872675) (y 82.89180722734923))
      (Point (x 3.2771179601510165) (y 82.89180722734923))
      (Point (x 3.2771179601510165) (y 83.12313320100697))
      (Point (x 33.07961423305379) (y 83.12313320100697))
    )
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._a1Compb1.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 3.2771179601510165) (y 82.69903558263448))
      (Point (x 3.2771179601510165) (y -41.137468982131))
      (Point (x 34.77600470654373) (y -41.137468982131))
    )
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._a0Compb0.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -7.2096595123322365) (y -61.68692630872501))
      (Point (x 14.457873353607425) (y -61.68692630872501))
      (Point (x 14.457873353607425) (y 62.76644751912771))
      (Point (x 33.07961423305379) (y 62.76644751912771))
    )
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._a0Compb0.outPortGt._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -53.86039753330553) (y -117.59070327600706))
      (Point (x 25.869954720721555) (y -117.59070327600706))
      (Point (x 25.869954720721555) (y -60.64595942726528))
      (Point (x 34.77600470654373) (y -60.64595942726528))
    )
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._andGt._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 88.63640223984926) (y -51.315811823070625))
      (Point (x 97.73522387038619) (y -51.315811823070625))
      (Point (x 97.73522387038619) (y 9.638582235738284))
      (Point (x 127.84615477483261) (y 9.638582235738284))
    )
  )
  
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._a1Compb1.outPortGt._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -53.39774558599009) (y 27.373573549496726))
      (Point (x 125.87988399874199) (y 27.373573549496726))
    )
  )
)

(def Comparator4
  (Comparator2
    (dataKey _comp1)
    (x -110)
    (y 155)
  )
  (Comparator2
    (dataKey _comp2)
    (x -111)
    (y -158)
  )
  (AndGate
    (dataKey _andEq)
    (x 264)
    (y -75)
  )
  (AndGate
    (dataKey _andGt)
    (x 146)
    (y 59)
  )
  (OrGate
    (dataKey _orGt)
    (x 260)
    (y 122)
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._comp1.outPortGt._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 70) (y 173))
      (Point (x 149) (y 173))
      (Point (x 149) (y 132))
      (Point (x 243) (y 132))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._comp1.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -23) (y 227))
      (Point (x 88) (y 227))
      (Point (x 88) (y 69))
      (Point (x 122) (y 69))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._comp1.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 88) (y 69))
      (Point (x 88) (y -65))
      (Point (x 240) (y -65))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._comp2.outPortGt._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 70) (y -140))
      (Point (x 106) (y -140))
      (Point (x 106) (y 49))
      (Point (x 122) (y 49))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._comp2.outPortEq._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -24) (y -85))
      (Point (x 240) (y -85))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._andGt.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 176) (y 59))
      (Point (x 201) (y 59))
      (Point (x 201) (y 113))
      (Point (x 243) (y 113))
    )
  )
)

(def Mux1
  (NotGate
    (dataKey _not)
    (x -75)
    (y 12)
  )
  (AndGate
    (dataKey _and1)
    (x -8)
    (y 25)
  )
  (AndGate
    (dataKey _and2)
    (x -8)
    (y -25)
  )
  (OrGate
    (dataKey _or)
    (x 83.64950610051862)
    (y -0.7009877989627853)
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._inS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -103.22045339726996) (y 12.617780381330116))
      (Point (x -103.22045339726996) (y -12.267286481848723))
      (Point (x -32.07019180254738) (y -12.267286481848723))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._inS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -115.83823377860008) (y 12.617780381330116))
      (Point (x -90.25217911645846) (y 12.617780381330116))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._not.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -52.04834407298672) (y 11.91679258236733))
      (Point (x -32.07019180254738) (y 11.91679258236733))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._inA._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -32.07019180254738) (y 37.85334114399035))
      (Point (x -116.18872767808148) (y 37.85334114399035))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._inB._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -32.07019180254738) (y -37.152353345027564))
      (Point (x -115.1372459796373) (y -37.152353345027564))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._and1.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 22.256362617068397) (y 24.88506686317884))
      (Point (x 43.986984384914706) (y 24.88506686317884))
      (Point (x 43.986984384914706) (y 9.463335285997587))
      (Point (x 67.82056954964936) (y 9.463335285997587))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._and2.outPort._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x 22.256362617068397) (y -25.23556076266023))
      (Point (x 43.986984384914706) (y -25.23556076266023))
      (Point (x 43.986984384914706) (y -11.56629868288594))
      (Point (x 67.11958175068658) (y -11.56629868288594))
    )
  )
)

(def Mux2
  (Mux1
    (dataKey _muxX)
    (y 54)
  )
  (Mux1
    (dataKey _muxY)
    (y -54)
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -115.7171556610243) (y 66.71055536999182))
      (Point (x -135.21716415379115) (y 66.71055536999182))
      (Point (x -135.21716415379115) (y 91.85530316329644))
      (Point (x -172.6777067846327) (y 91.85530316329644))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -115.7171556610243) (y -41.56580757668722))
      (Point (x -135.21716415379115) (y -41.56580757668722))
      (Point (x -135.21716415379115) (y 65.68423913353041))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA1._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -116.230313779255) (y 91.85530316329644))
      (Point (x -121.87505307979276) (y 91.85530316329644))
      (Point (x -121.87505307979276) (y 46.69738875899428))
      (Point (x -171.1382324299406) (y 46.69738875899428))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA0._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -116.230313779255) (y -16.421059783382603))
      (Point (x -160.87507006532644) (y -16.421059783382603))
      (Point (x -160.87507006532644) (y 15.907901665151897))
      (Point (x -170.11191619347917) (y 15.907901665151897))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB1._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -115.20399754279359) (y 16.934217901613312))
      (Point (x -148.0461171095588) (y 16.934217901613312))
      (Point (x -148.0461171095588) (y -58.50002547830053))
      (Point (x -167.54612560232565) (y -58.50002547830053))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB0._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -115.20399754279359) (y -91.34214504506573))
      (Point (x -167.03296748409494) (y -91.34214504506573))
    )
  )
)

(def Mux4
  (Mux2
    (dataKey _muxX)
    (y 106)
  )
  (Mux2
    (dataKey _muxY)
    (y -106)
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -240.60701268542252) (y 198.0739020558704))
      (Point (x -172.5) (y 198.0739020558704))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortS._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -174.16843111809294) (y 198.0739020558704))
      (Point (x -174.16843111809294) (y -14.281190430360562))
      (Point (x -171.6847458258563) (y -14.281190430360562))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA3._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -171.06382450279716) (y 152.7466454725521))
      (Point (x -239.98609136236337) (y 152.7466454725521))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA2._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -169.82198185667886) (y 121.70057931959435))
      (Point (x -239.98609136236337) (y 121.70057931959435))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA1._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -171.06382450279716) (y -59.60844701367887))
      (Point (x -187.2077789023352) (y -59.60844701367887))
      (Point (x -187.2077789023352) (y 96.24280507416901))
      (Point (x -239.98609136236337) (y 96.24280507416901))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortA0._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -169.82198185667886) (y -90.03359184357745))
      (Point (x -199.6262053635183) (y -90.03359184357745))
      (Point (x -199.6262053635183) (y 65.19673892121126))
      (Point (x -239.36517003930422) (y 65.19673892121126))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB3._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -235.6396421009493) (y -103.69386095087886))
      (Point (x -225.7049009320028) (y -103.69386095087886))
      (Point (x -225.7049009320028) (y 47.810941875554924))
      (Point (x -167.33829656444223) (y 47.810941875554924))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB2._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -235.0187207778901) (y -134.11900578077746))
      (Point (x -212.66555314776053) (y -134.11900578077746))
      (Point (x -212.66555314776053) (y 14.902111753419717))
      (Point (x -167.33829656444223) (y 14.902111753419717))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB1._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -167.33829656444223) (y -164.54415061067604))
      (Point (x -235.0187207778901) (y -164.54415061067604))
    )
  )
  (MultiLine
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data.inPortB0._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (points
      (Point (x -166.71737524138308) (y -197.45298073281126))
      (Point (x -235.6396421009493) (y -197.45298073281126))
    )
  )
)

(def SwapIfGreater4
  (Comparator4
    (dataKey _comp4)
    (x -315)
  )
  
  (Mux4
    (dataKey _muxX)
    (x 475)
    (y 215)
  )
  
  (Mux4
    (dataKey _muxY)
    (x 475)
    (y -215)
  )
)

(def Swap4Set
  (List
    (dataKey _swaps)
    (of
      (SwapIfGreater4
        (y $index * -1200)
      )
    )
  )
)

(def Binary4Input
  (List
    (y 200)
    (dataKey _switches)
    (of
      (Switch
        (y $index * -120)
      )
    )
  )
)

(def Binary4Output
  (List
    (y 200)
    (dataKey _outputs)
    (of
      (Probe
        (y $index * -120)
      )
    )
  )
)

(def BubbleSort
  (List
    (dataKey _swapSets)
    (of
      (Swap4Set
        (x $index * 1400)
      )
    )
  )
  (List
    (dataKey _inputs)
    (of
      (Binary4Input
        (x -800)
        (y $index * -1030)
      )
    )
  )
  (List
    (dataKey _outputs)
    (of
      (Binary4Output
        (x 9200)
        (y $index * -1030)
      )
    )
  )
)

(Group
  (x -300)
  (children
    (Switch
      (name sw1)
      (dataKey sw1)
      (y 80)
    )
    (Switch
      (name sw2)
      (dataKey sw2)
      (y 60)
    )
    (Switch
      (name sw3)
      (dataKey sw3)
      (y 40)
    )
    (Switch
      (name sw4)
      (dataKey sw4)
      (y 20)
    )
    (Switch
      (name sw5)
      (dataKey sw5)
      (y -20)
    )
    (Switch
      (name sw6)
      (dataKey sw6)
      (y -40)
    )
    (Switch
      (name sw7)
      (dataKey sw7)
      (y -60)
    )
    (Switch
      (name sw8)
      (dataKey sw8)
      (y -80)
    )
    (Switch
      (name sw9)
      (dataKey sw9)
      (y -120)
    )
  )
)


#(BubbleSort
#  (dataKey bubbleSort)
#  (x -4000)
#  (y 3500)
#)

(Mux4
  (dataKey mux4)
)
