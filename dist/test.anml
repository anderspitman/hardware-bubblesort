(def LOW_COLOR #505050)
(def HIGH_COLOR #71ed55)
(def WIRE_WIDTH 3)
(def BACKGROUND_COLOR #ffffff)

(def Switch
  (Rectangle
    (strokeColor LOW_COLOR)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 100)
    (height 100)
  )
)

(def Probe 
  (Circle
    (strokeColor LOW_COLOR)
    (fillColor $data._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 50)
  )
)

(def AndGate
  (Rectangle
    (x -6)
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 36)
    (height 40)
  )
  (Arc
    (x 10)
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 20)
    (startAngle -1.57)
    (endAngle 1.57)
  )
)

(def OrGate
  (Rectangle
    (x -6)
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (width 35)
    (height 40)
  )
  (Triangle
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 10) (y1 20)
    (x2 40) (y2 0)
    (x3 10) (y3 -20)
  )
  (Arc
    (x -40)
    (strokeColor none)
    (fillColor BACKGROUND_COLOR)
    (radius 25)
    (startAngle -1.2)
    (endAngle 1.2)
  )
)

(def NotGate
  (Triangle
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -15) (y1 15)
    (x2 15) (y2 0)
    (x3 -15) (y3 -15)
  )
  (Circle
    (x 18)
    (strokeColor none)
    (fillColor $data._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 5)
  )
)

(def NandGate
  (AndGate
    (dataKey _not)
  )
  (Circle
    (x 34)
    (strokeColor none)
    (fillColor $data._not._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (radius 5)
  )
)

(def XnorGate
  (OrGate
    (dataKey _or)
    (x -27)
    (y 24)
  )
  (NandGate
    (dataKey _nand1)
    (x -27)
    (y -25)
  )
  (NandGate
    (dataKey _nand2)
    (x 70)
    (y -15)
  )
)

(def GreaterThan1
  (AndGate
    (dataKey _and)
    (x 32)
  )
  (NotGate
    (dataKey _not)
    (x -35)
    (y -10)
  )
  (Line
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._and._inA._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -50) (y1 10)
    (x2 9) (y2 10)
  )
  (Line
    (strokeWidth WIRE_WIDTH)
    (strokeColor $data._not._out._state == 0 ? LOW_COLOR : HIGH_COLOR)
    (x1 -13) (y1 -10)
    (x2 9) (y2 -10)
  )
)

(def Comparator1
  (XnorGate
    (dataKey _xnor)
    (y 30)
  )
  (GreaterThan1
    (dataKey _gt)
    (y -40)
  )
)

(def Comparator2
  (Comparator1
    (dataKey _a1Compb1)
    (x -115)
    (y 73)
  )
  (Comparator1
    (dataKey _a0Compb0)
    (x -116)
    (y -79)
  )
  (AndGate
    (dataKey _andEq)
    (x 57)
    (y 73)
  )
  (AndGate
    (dataKey _andGt)
    (x 59)
    (y -51)
  )
  (OrGate
    (dataKey _or)
    (x 142)
  )
)

(def Comparator4
  (Comparator2
    (dataKey _comp1)
    (x -111)
    (y -158)
  )
  (Comparator2
    (dataKey _comp2)
    (x -110)
    (y 155)
  )
  (AndGate
    (dataKey _andEq)
    (x 264)
    (y -89)
  )
  (AndGate
    (dataKey _andGt)
    (x 146)
    (y 59)
  )
  (OrGate
    (dataKey _orGt)
    (x 260)
    (y 122)
  )
)

(def Mux1
  (NotGate
    (dataKey _not)
    (x -75)
    (y 12)
  )
  (AndGate
    (dataKey _and1)
    (x -8)
    (y 25)
  )
  (AndGate
    (dataKey _and2)
    (x -8)
    (y -25)
  )
  (OrGate
    (dataKey _or)
    (x 84)
  )
)

(def Mux2
  (Mux1
    (dataKey _muxX)
    (y 54)
  )
  
  (Mux1
    (dataKey _muxY)
    (y -54)
  )
)

(def Mux4
  (Mux2
    (dataKey _muxX)
    (y 106)
  )
  
  (Mux2
    (dataKey _muxY)
    (y -106)
  )
)


#(Group
#  (x -800)
#  (y 800)
#  (children
#    (Switch
#      (name sw1)
#      (dataKey sw1)
#      (y 300)
#    )
#    (Switch
#      (name sw2)
#      (dataKey sw2)
#      (y 200)
#    )
#    (Switch
#      (name sw3)
#      (dataKey sw3)
#      (y 100)
#    )
#    (Switch
#      (name sw4)
#      (dataKey sw4)
#    )
#    (Switch
#      (name sw5)
#      (dataKey sw5)
#      (y -100)
#    )
#    (Switch
#      (name sw6)
#      (dataKey sw6)
#      (y -200)
#    )
#    (Switch
#      (name sw7)
#      (dataKey sw7)
#      (y -300)
#    )
#    (Switch
#      (name sw8)
#      (dataKey sw8)
#      (y -400)
#    )
#  )
#)

#(Rectangle
#  (name box)
#  (strokeColor red)
#  (fillColor none)
#  (width 200)
#  (height 200)
#)
#
#(Rectangle
#  (name box)
#  (strokeColor blue)
#  (fillColor none)
#  (width 400)
#  (height 400)
#)

(def SwapIfGreater4
  (Comparator4
    (dataKey _comp4)
    (x -315)
  )
  
  (Mux4
    (dataKey _muxX)
    (x 475)
    (y 215)
  )
  
  (Mux4
    (dataKey _muxY)
    (x 475)
    (y -215)
  )
)

(def Swap4Set
  (List
    (dataKey _swaps)
    (of
      (SwapIfGreater4
        (y $index * -1200)
      )
    )
  )
)

(def Binary4Input
  (List
    (y 200)
    (dataKey _switches)
    (of
      (Switch
        (y $index * -120)
      )
    )
  )
)

(def Binary4Output
  (List
    (y 200)
    (dataKey _outputs)
    (of
      (Probe
        (y $index * -120)
      )
    )
  )
)

(def BubbleSort
  (List
    (dataKey _swapSets)
    (of
      (Swap4Set
        (x $index * 1400)
      )
    )
  )
  (List
    (dataKey _inputs)
    (of
      (Binary4Input
        (x -800)
        (y $index * -1030)
      )
    )
  )
  (List
    (dataKey _outputs)
    (of
      (Binary4Output
        (x 9200)
        (y $index * -1030)
      )
    )
  )
)

#(BubbleSort
#  (dataKey bubbleSort)
#  (x -4000)
#  (y 3500)
#)

#(MultiLine
#  (points
#    (List
#      (of
#        (Point
#        )
#      )
#    )
#  )
#)

(AndGate
)

(Point
)

